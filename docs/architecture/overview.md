# Overview

Maigie is an AI-powered student companion that helps learners manage courses, set goals, discover resources, schedule study sessions, get forecasts and reminders, and converse with an intelligent assistant (text + voice). The codebase is a monorepo managed with **Nx**. The frontend stack uses **Vite + shadcn-ui** for web and **Expo** for mobile (React Native). The backend is **FastAPI** with clear service separation and AI integrations (vector DB, embeddings, LLMs).

# Maigie Architecture Overview

## 1. System Overview

Maigie is an AI-powered learning companion built on a distributed, scalable architecture using:

* **FastAPI** for backend logic
* **Vite + shadcn-ui** for the web frontend
* **Expo** for mobile
* **Nx** as the monorepo orchestrator
* **LLM-powered services** for intent detection, content generation, and recommendation
* **PostgreSQL + Prisma** as the database layer

---

## 2. High-Level Architecture

```
                 ┌──────────────────────────┐
                 │        Frontend          │
                 │ Web (Vite) / Mobile App │
                 └─────────────┬────────────┘
                               │
                               ▼
                  ┌────────────────────────┐
                  │      API Gateway       │
                  │     (FastAPI Root)     │
                  └────────────┬───────────┘
                               │
               ┌───────────────┴────────────────┐
               │                                │
               ▼                                ▼
   ┌──────────────────────┐         ┌─────────────────────────┐
   │  Core API Services   │         │     AI Engine Service  │
   │ Authentication        │         │ Intent Detection        │
   │ Courses/Goals         │         │ Recommendation Engine   │
   │ Schedules/Forecast    │         │ Prompt Orchestration    │
   └──────────────────────┘         └─────────────────────────┘
               │                                │
               └──────────────┬─────────────────┘
                              │
                              ▼
                   ┌──────────────────┐
                   │ PostgreSQL DB    │
                   │  (Prisma ORM)    │
                   └──────────────────┘
```

---

## 3. Backend Services

### **3.1 Api Gateway**

Handles routing, authentication validation, throttling, and core REST endpoints.

### **3.2 AI Engine**

* Intent detection
* AI-created courses, schedules, goals, reminders
* Recommendation engine
* Voice assistant NLU integration

### **3.3 Event System**

Used for automatic AI actions.

Events include:

* `ai.course.created`
* `ai.goal.created`
* `ai.schedule.generated`
* `ai.recommendation.created`
* `ai.voice.transcript`

---

## 4. Frontend Architecture

### Web (Vite + shadcn)

* Modular UI components
* Dashboard widgets for Courses, Goals, Schedules, Resources
* Real-time AI chat interface
* Subscription billing screens

### Mobile (Expo)

* Offline-first design
* Same structure as web via shared logic
* Push notifications for schedules and reminders

---

## 5. AI Flow

1. User enters chat or voice command
2. Message sent to `/ai/process`
3. Intent engine classifies it
4. Decision engine decides whether AI should:

   * Create something
   * Recommend resources
   * Ask clarifying questions
5. If creation intent → event fired
6. Event handler updates DB
7. UI receives update through polling or websocket

---

## 6. Database (Prisma)

Includes: users, subscriptions, courses, goals, schedules, voice logs, intents, AI events.

---

## 7. Security Architecture

* JWT-based auth
* RBAC for organizations
* Rate limits on `/ai` endpoints
* Sanitization for LLM outputs
* Encrypted storage for sensitive metadata

---

## 8. Scalability Approach

* Horizontal API scaling
* Async background jobs
* Caching for frequently read resources
* Streaming endpoints for conversational responses

---

# High-level Requirements & Features

* **AI‑first operations**: Courses, goals, and schedules can be *auto-generated* by the AI assistant during conversations.

  * User can manually edit or add more items, but AI generation is the default.
  * Example: User says *"I want to learn Data Structures for my exam in 6 weeks"* → AI creates a course outline, sets goals, and builds a study schedule.
  * Example: User says *"Help me plan tomorrow"* → AI analyzes workload and generates a daily schedule.

* User auth (email/password, social sign-in)

* Create & manage Courses (AI-generated syllabus or manual input)

* Create Goals (AI interprets intent and sets milestones automatically)

* Resource recommendations (links, videos, PDFs) — generated by AI and curated by user

* Schedule (daily view, time blocks, recurring sessions) — AI suggests optimized plan automatically

* Forecast (AI-driven estimates of progress by date given study habits)

* Reminders & notifications (push, email)

* AI Assistant (chat + voice): ask about courses, get study plans, request resources, ask clarifying questions

* Dashboard organization: courses, goals, resources, daily schedule, forecast, reminders

* Offline-first support on mobile (Expo + local DB like WatermelonDB / SQLite sync)

* Analytics, usage metrics, privacy and consent controls

---

# Non-functional Considerations

* Design for incremental adoption: start with text-chat, notes, courses and a simple scheduler; add voice and forecasting later.
* Keep per-user data partitioned and scalable.
* Cost control for LLM usage: caching, summarization instead of full re-generation for repeated queries, tiered quotas.

